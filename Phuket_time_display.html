<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –≤ –ü—Ö—É–∫–µ—Ç–µ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f7fa;
            color: #333;
        }
        
        .container {
            background-color: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-top: 20px;
            text-align: center;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .time-display {
            font-size: 3em;
            font-weight: bold;
            color: #e74c3c;
            margin: 20px 0;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
        }
        
        .details {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: left;
        }
        
        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .detail-row:last-child {
            border-bottom: none;
        }
        
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 16px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        .loading {
            color: #7f8c8d;
            font-style: italic;
        }
        
        .error {
            color: #c0392b;
            padding: 15px;
            background-color: #fadbd8;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .success {
            color: #27ae60;
            padding: 10px;
            background-color: #d5f4e6;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 0.9em;
        }
        
        .auto-update {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        
        .timezone-info {
            color: #27ae60;
            font-weight: bold;
        }
        
        .flag {
            font-size: 1.5em;
        }
        
        .api-selector {
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 8px;
        }
        
        .api-selector label {
            margin-right: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1><span class="flag">üáπüá≠</span> –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –≤ –ü—Ö—É–∫–µ—Ç–µ</h1>
        
        <div class="api-selector">
            <label>
                <input type="radio" name="api" value="worldtime" checked onchange="changeAPI()"> WorldTimeAPI
            </label>
            <label>
                <input type="radio" name="api" value="timeapi" onchange="changeAPI()"> TimeAPI.io
            </label>
            <label>
                <input type="radio" name="api" value="proxy" onchange="changeAPI()"> CORS-–ø—Ä–æ–∫—Å–∏
            </label>
        </div>
        
        <div class="time-display" id="currentTime">
            <span class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –≤—Ä–µ–º–µ–Ω–∏...</span>
        </div>
        
        <div id="apiStatus" class="success" style="display: none;">
            –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è API: <span id="currentAPI">WorldTimeAPI</span>
        </div>
        
        <div>
            <button onclick="fetchTime()">–û–±–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º—è</button>
            <button onclick="toggleAutoUpdate()" id="autoUpdateBtn">–í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</button>
        </div>
        
        <div class="auto-update">
            <input type="checkbox" id="autoUpdateCheckbox" onchange="toggleAutoUpdate()">
            <label for="autoUpdateCheckbox">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥</label>
        </div>
        
        <div class="details" id="timeDetails">
            <div class="detail-row">
                <span>–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å:</span>
                <span class="timezone-info" id="timezone">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
            <div class="detail-row">
                <span>–î–∞—Ç–∞:</span>
                <span id="date">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
            <div class="detail-row">
                <span>–î–µ–Ω—å –Ω–µ–¥–µ–ª–∏:</span>
                <span id="day">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
            <div class="detail-row">
                <span>–í—Ä–µ–º—è –ø–æ UTC:</span>
                <span id="utc">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
        </div>
        
        <div id="errorMessage" class="error" style="display: none;"></div>
    </div>

    <script>
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API
        const API_CONFIG = {
            worldtime: {
                name: "WorldTimeAPI",
                url: 'https://worldtimeapi.org/api/timezone/Asia/Bangkok',
                direct: true
            },
            timeapi: {
                name: "TimeAPI.io",
                url: 'https://timeapi.io/api/Time/current/zone?timeZone=Asia/Bangkok',
                direct: true
            },
            proxy: {
                name: "CORS-–ø—Ä–æ–∫—Å–∏",
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º CORS-–ø—Ä–æ–∫—Å–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ª—é–±–æ–º—É API
                url: 'https://api.allorigins.win/raw?url=',
                target: 'http://worldtimeapi.org/api/timezone/Asia/Bangkok',
                direct: false
            }
        };
        
        let currentAPI = 'worldtime';
        let autoUpdateInterval = null;
        let isAutoUpdating = false;
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ —Å –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ API
        async function fetchTime() {
            const timeDisplay = document.getElementById('currentTime');
            const errorMessage = document.getElementById('errorMessage');
            const apiStatus = document.getElementById('apiStatus');
            const currentAPISpan = document.getElementById('currentAPI');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
            timeDisplay.innerHTML = '<span class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –≤—Ä–µ–º–µ–Ω–∏...</span>';
            errorMessage.style.display = 'none';
            apiStatus.style.display = 'none';
            
            const config = API_CONFIG[currentAPI];
            currentAPISpan.textContent = config.name;
            
            try {
                let apiUrl = config.url;
                
                // –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–∫—Å–∏, –¥–æ–±–∞–≤–ª—è–µ–º —Ü–µ–ª–µ–≤–æ–π URL
                if (!config.direct && config.target) {
                    apiUrl = config.url + encodeURIComponent(config.target);
                }
                
                console.log(`–ó–∞–ø—Ä–æ—Å –∫ API: ${apiUrl}`);
                
                // –î–µ–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å —Å —Ç–∞–π–º–∞—É—Ç–æ–º
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 5000);
                
                const response = await fetch(apiUrl, {
                    signal: controller.signal,
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                
                clearTimeout(timeoutId);
                
                if (!response.ok) {
                    throw new Error(`–û—à–∏–±–∫–∞ HTTP: ${response.status} ${response.statusText}`);
                }
                
                const data = await response.json();
                
                // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç API
                let datetime, timezone, utcTime;
                
                if (currentAPI === 'worldtime' || currentAPI === 'proxy') {
                    // –§–æ—Ä–º–∞—Ç WorldTimeAPI
                    datetime = new Date(data.datetime);
                    timezone = data.timezone || 'Asia/Bangkok';
                    utcTime = data.utc_datetime;
                } else if (currentAPI === 'timeapi') {
                    // –§–æ—Ä–º–∞—Ç TimeAPI.io
                    datetime = new Date(data.dateTime);
                    timezone = data.timeZone || 'Asia/Bangkok';
                    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ UTC –≤—Ä–µ–º—è
                    utcTime = datetime.toISOString();
                }
                
                // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤—Ä–µ–º—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                const formattedTime = datetime.toLocaleTimeString('ru-RU', {
                    timeZone: 'Asia/Bangkok',
                    hour12: false,
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                
                const formattedDate = datetime.toLocaleDateString('ru-RU', {
                    timeZone: 'Asia/Bangkok',
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                const dayNames = [
                    '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ', '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–í—Ç–æ—Ä–Ω–∏–∫', '–°—Ä–µ–¥–∞', 
                    '–ß–µ—Ç–≤–µ—Ä–≥', '–ü—è—Ç–Ω–∏—Ü–∞', '–°—É–±–±–æ—Ç–∞'
                ];
                
                const dayName = dayNames[datetime.getDay()];
                
                // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º UTC –≤—Ä–µ–º—è
                const utcDate = new Date(utcTime);
                const formattedUTC = utcDate.toLocaleTimeString('ru-RU', {
                    hour12: false,
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                }) + ' UTC';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º DOM
                timeDisplay.textContent = formattedTime;
                document.getElementById('timezone').textContent = timezone;
                document.getElementById('date').textContent = formattedDate;
                document.getElementById('day').textContent = dayName;
                document.getElementById('utc').textContent = formattedUTC;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
                apiStatus.style.display = 'block';
                console.log(`–í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–æ —á–µ—Ä–µ–∑ ${config.name}: ${formattedTime}`);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏:', error);
                
                // –ü—Ä–æ–±—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–ø–∞—Å–Ω–æ–π API
                if (currentAPI !== 'proxy') {
                    console.log('–ü—Ä–æ–±—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π API...');
                    if (currentAPI === 'worldtime') {
                        currentAPI = 'timeapi';
                    } else if (currentAPI === 'timeapi') {
                        currentAPI = 'proxy';
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–¥–∏–æ-–∫–Ω–æ–ø–∫—É
                    document.querySelector(`input[name="api"][value="${currentAPI}"]`).checked = true;
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏
                    errorMessage.textContent = `${config.name} –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü—Ä–æ–±—É–µ–º ${API_CONFIG[currentAPI].name}...`;
                    errorMessage.style.display = 'block';
                    
                    // –ü–æ–≤—Ç–æ—Ä—è–µ–º –∑–∞–ø—Ä–æ—Å —Å –Ω–æ–≤—ã–º API
                    setTimeout(fetchTime, 1000);
                    return;
                }
                
                // –ï—Å–ª–∏ –≤—Å–µ API –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —Å –ø–æ–ø—Ä–∞–≤–∫–æ–π –Ω–∞ –ü—Ö—É–∫–µ—Ç
                errorMessage.textContent = `–í—Å–µ API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è (—Ä–∞–∑–Ω–∏—Ü–∞ —Å UTC: +7 —á–∞—Å–æ–≤).`;
                errorMessage.style.display = 'block';
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —Å –ø–æ–ø—Ä–∞–≤–∫–æ–π –Ω–∞ UTC+7
                const now = new Date();
                const localTimeUTC = now.getTime() + (now.getTimezoneOffset() * 60000);
                const phuketTime = new Date(localTimeUTC + (7 * 3600000)); // UTC+7
                
                const fallbackTime = phuketTime.toLocaleTimeString('ru-RU', {
                    hour12: false,
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                
                const fallbackDate = phuketTime.toLocaleDateString('ru-RU', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                timeDisplay.innerHTML = `<span style="color:#7f8c8d;">${fallbackTime} (–ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ)</span>`;
                document.getElementById('timezone').textContent = 'Asia/Bangkok (–ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ)';
                document.getElementById('date').textContent = fallbackDate;
                document.getElementById('day').textContent = dayNames[phuketTime.getDay()];
                document.getElementById('utc').textContent = now.toISOString().substr(11, 8) + ' UTC';
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–º–µ–Ω—ã API
        function changeAPI() {
            const selectedAPI = document.querySelector('input[name="api"]:checked').value;
            currentAPI = selectedAPI;
            fetchTime();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è/–≤—ã–∫–ª—é—á–µ–Ω–∏—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        function toggleAutoUpdate() {
            const checkbox = document.getElementById('autoUpdateCheckbox');
            const button = document.getElementById('autoUpdateBtn');
            
            if (checkbox.checked && !isAutoUpdating) {
                // –í–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                isAutoUpdating = true;
                autoUpdateInterval = setInterval(fetchTime, 10000); // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
                button.textContent = '–í—ã–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ';
                console.log('–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ');
            } else {
                // –í—ã–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                isAutoUpdating = false;
                if (autoUpdateInterval) {
                    clearInterval(autoUpdateInterval);
                    autoUpdateInterval = null;
                }
                checkbox.checked = false;
                button.textContent = '–í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ';
                console.log('–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–∫–ª—é—á–µ–Ω–æ');
            }
        }
        
        // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ TimeAPI.io
        async function fetchTimeFromTimeAPI() {
            try {
                // TimeAPI.io –æ–±—ã—á–Ω–æ —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å CORS
                const response = await fetch('https://timeapi.io/api/Time/current/zone?timeZone=Asia/Bangkok', {
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                
                if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ TimeAPI');
                
                const data = await response.json();
                return {
                    datetime: new Date(data.dateTime),
                    timezone: data.timeZone,
                    success: true
                };
            } catch (error) {
                console.log('TimeAPI.io –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:', error);
                return { success: false };
            }
        }
        
        // –ü–æ–ª—É—á–∞–µ–º –≤—Ä–µ–º—è —Å—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', fetchTime);
    </script>
</body>
</html>